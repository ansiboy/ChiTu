{"version":3,"sources":["../es6/Application.js"],"names":["define","require","exports","maishu_chitu_service_1","PageMaster_1","Errors_1","Object","defineProperty","value","EmtpyStateData","DefaultPageName","parseUrl","app","url","Errors","argumentNull","sharpIndex","indexOf","routeString","substr","canntParseRouteString","startsWith","routePath","search","param_spliter_index","substring","values","pareeUrlQuery","pageName","query","match","pl","decode","s","decodeURIComponent","replace","urlParams","exec","createUrl","params","path_parts","split","path","join","paramsText","key","type","Application","args","container","document","body","parser","_runned","closeCurrentOnBack","tempPageData","undefined","routeData","showPage","location","href","showPageByUrl","window","addEventListener","fromCache","noneRouteMatched","fetchTemplatePageData","result","closeCurrentPage","currentPage","page","pageStack","pop","Error","hide","name","assign","data","history","pushState","pageNameOrUrl","showPageByNameOrUrl","setLocationHash","setUrl","rerender","obj","closeCurrentPageDefault","back","Service","service","error","add","sender","fire","PageMaster"],"mappings":"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","sourcesContent":["define([\"require\", \"exports\", \"maishu-chitu-service\", \"./PageMaster\", \"./Errors\"], function (require, exports, maishu_chitu_service_1, PageMaster_1, Errors_1) {\r\n    \"use strict\";\r\n    Object.defineProperty(exports, \"__esModule\", { value: true });\r\n    const EmtpyStateData = \"\";\r\n    const DefaultPageName = \"index\";\r\n    function parseUrl(app, url) {\r\n        if (!app)\r\n            throw Errors_1.Errors.argumentNull('app');\r\n        if (!url)\r\n            throw Errors_1.Errors.argumentNull('url');\r\n        let sharpIndex = url.indexOf('#');\r\n        let routeString;\r\n        if (sharpIndex >= 0)\r\n            routeString = url.substr(sharpIndex + 1);\r\n        else\r\n            routeString = url;\r\n        if (!routeString)\r\n            throw Errors_1.Errors.canntParseRouteString(url);\r\n        if (routeString.startsWith('!')) {\r\n            throw Errors_1.Errors.canntParseRouteString(routeString);\r\n        }\r\n        let routePath;\r\n        let search = null;\r\n        let param_spliter_index = routeString.indexOf('?');\r\n        if (param_spliter_index >= 0) {\r\n            search = routeString.substr(param_spliter_index + 1);\r\n            routePath = routeString.substring(0, param_spliter_index);\r\n        }\r\n        else {\r\n            routePath = routeString;\r\n        }\r\n        if (!routePath)\r\n            routePath = DefaultPageName;\r\n        let values = {};\r\n        if (search) {\r\n            values = pareeUrlQuery(search);\r\n        }\r\n        let pageName = routePath;\r\n        return { pageName, values };\r\n    }\r\n    function pareeUrlQuery(query) {\r\n        let match, pl = /\\+/g, search = /([^&=]+)=?([^&]*)/g, decode = function (s) { return decodeURIComponent(s.replace(pl, \" \")); };\r\n        let urlParams = {};\r\n        while (match = search.exec(query))\r\n            urlParams[decode(match[1])] = decode(match[2]);\r\n        return urlParams;\r\n    }\r\n    function createUrl(pageName, params) {\r\n        let path_parts = pageName.split('.');\r\n        let path = path_parts.join('/');\r\n        if (!params)\r\n            return `#${path}`;\r\n        let paramsText = '';\r\n        for (let key in params) {\r\n            let value = params[key];\r\n            let type = typeof params[key];\r\n            if (type != 'string' || value == null) {\r\n                continue;\r\n            }\r\n            paramsText = paramsText == '' ? `?${key}=${params[key]}` : paramsText + `&${key}=${params[key]}`;\r\n        }\r\n        return `#${path}${paramsText}`;\r\n    }\r\n    class Application extends PageMaster_1.PageMaster {\r\n        constructor(args) {\r\n            super((args || {}).container || document.body, (args || {}).parser);\r\n            this._runned = false;\r\n            this.closeCurrentOnBack = null;\r\n            this.tempPageData = undefined;\r\n        }\r\n        parseUrl(url) {\r\n            if (!url)\r\n                throw Errors_1.Errors.argumentNull('url');\r\n            let routeData = parseUrl(this, url);\r\n            return routeData;\r\n        }\r\n        createUrl(pageName, values) {\r\n            return createUrl(pageName, values);\r\n        }\r\n        run() {\r\n            if (this._runned)\r\n                return;\r\n            let showPage = () => {\r\n                let url = location.href;\r\n                let sharpIndex = url.indexOf('#');\r\n                let routeString = url.substr(sharpIndex + 1);\r\n                if (routeString.startsWith('!')) {\r\n                    return;\r\n                }\r\n                if (sharpIndex < 0) {\r\n                    url = '#' + DefaultPageName;\r\n                }\r\n                this.showPageByUrl(url, true);\r\n            };\r\n            showPage();\r\n            window.addEventListener('popstate', () => {\r\n                showPage();\r\n            });\r\n            this._runned = true;\r\n        }\r\n        showPageByUrl(url, fromCache) {\r\n            if (!url)\r\n                throw Errors_1.Errors.argumentNull('url');\r\n            var routeData = this.parseUrl(url);\r\n            if (routeData == null) {\r\n                throw Errors_1.Errors.noneRouteMatched(url);\r\n            }\r\n            let tempPageData = this.fetchTemplatePageData();\r\n            let result = null;\r\n            if (this.closeCurrentOnBack == true) {\r\n                this.closeCurrentOnBack = null;\r\n                if (tempPageData == null)\r\n                    this.closeCurrentPage();\r\n                else\r\n                    this.closeCurrentPage(tempPageData);\r\n                result = this.currentPage;\r\n            }\r\n            else if (this.closeCurrentOnBack == false) {\r\n                this.closeCurrentOnBack = null;\r\n                var page = this.pageStack.pop();\r\n                if (page == null)\r\n                    throw new Error('page is null');\r\n                page.hide(this.currentPage);\r\n                result = this.currentPage;\r\n            }\r\n            if (result == null || result.name != routeData.pageName) {\r\n                let args = routeData.values || {};\r\n                if (tempPageData) {\r\n                    args = Object.assign(args, tempPageData);\r\n                }\r\n                result = this.showPage(routeData.pageName, args);\r\n            }\r\n            return result;\r\n        }\r\n        fetchTemplatePageData() {\r\n            if (this.tempPageData == null) {\r\n                return null;\r\n            }\r\n            let data = this.tempPageData;\r\n            this.tempPageData = undefined;\r\n            return data;\r\n        }\r\n        setLocationHash(url) {\r\n            history.pushState(EmtpyStateData, \"\", url);\r\n        }\r\n        redirect(pageNameOrUrl, args) {\r\n            if (!pageNameOrUrl)\r\n                throw Errors_1.Errors.argumentNull('pageNameOrUrl');\r\n            let page = this.showPageByNameOrUrl(pageNameOrUrl, args);\r\n            let url = this.createUrl(page.name, page.data);\r\n            this.setLocationHash(url);\r\n            return page;\r\n        }\r\n        forward(pageNameOrUrl, args, setUrl) {\r\n            if (!pageNameOrUrl)\r\n                throw Errors_1.Errors.argumentNull('pageNameOrUrl');\r\n            if (setUrl == null)\r\n                setUrl = true;\r\n            let page = this.showPageByNameOrUrl(pageNameOrUrl, args, true);\r\n            if (setUrl) {\r\n                let url = this.createUrl(page.name, page.data);\r\n                this.setLocationHash(url);\r\n            }\r\n            else {\r\n                history.pushState(pageNameOrUrl, \"\", \"\");\r\n            }\r\n            return page;\r\n        }\r\n        showPageByNameOrUrl(pageNameOrUrl, args, rerender) {\r\n            let pageName;\r\n            if (pageNameOrUrl.indexOf('?') < 0) {\r\n                pageName = pageNameOrUrl;\r\n            }\r\n            else {\r\n                let obj = this.parseUrl(pageNameOrUrl);\r\n                pageName = obj.pageName;\r\n                args = Object.assign(obj.values, args || {});\r\n            }\r\n            return this.showPage(pageName, args, rerender);\r\n        }\r\n        reload(pageName, args) {\r\n            let result = this.showPage(pageName, args, true);\r\n            return result;\r\n        }\r\n        back(closeCurrentPage, data) {\r\n            const closeCurrentPageDefault = true;\r\n            if (typeof closeCurrentPage == 'object') {\r\n                data = closeCurrentPage;\r\n                closeCurrentPage = null;\r\n            }\r\n            this.closeCurrentOnBack = closeCurrentPage == null ? closeCurrentPageDefault : closeCurrentPage;\r\n            this.tempPageData = data;\r\n            history.back();\r\n        }\r\n        createService(type) {\r\n            type = type || maishu_chitu_service_1.Service;\r\n            let service = new type();\r\n            service.error.add((sender, error) => {\r\n                this.error.fire(this, error, null);\r\n            });\r\n            return service;\r\n        }\r\n    }\r\n    exports.Application = Application;\r\n});\r\n"],"file":"Application.js"}